language: python
python:
  - '3.4'
  - '3.5'
  - nightly
services:
  - postgresql
  - rabbitmq
  - memcached
env:
  global:
    - DATABASE_URL='postgres://postgres:@localhost:/travis_ci_test'
  matrix:
    - DJANGO=1.9.6
    - DJANGO=latest
matrix:
  allow_failures:
    - python: nightly
install:
  - if [[ "$DJANGO" != "latest" ]] ; then pip install -q Django==$DJANGO; fi
  - pip install -r requirements.txt
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
script:
  - celery -A phoenix worker -l info --detach
  - python manage.py migrate --noinput
  - python manage.py test --noinput
before_deploy:
  - python manage.py collectstatic --noinput
deploy:
  edge: true
  provider: cloudfoundry
  username:
    secure: sQ4V9Ao2KzG4Kl6aaFhOxGLoHFYK+O7wBuebKxj5XIOCfhOpDNQPpoySuKP8OZNX0gsJ9Cw4xAveneyyEYp/VZSoMkX9W5BYXh1h7K2nyanoJVuZEviq2SkTwYr6l+XRvlB3kJu9QSWUfrinWVgCgSNJ1OaI22E/OBR1Mr7hEVpQFRl9TPGihHORc2RmCIdySjGNcgyuqZpJT6MB7oVMyC8dQwZs/qZL9aIXNqtr4T48ZjP3enUdsQ8gTM4BdiK79/otF17Fzy/jEGquwofYt9X8lB9hqqA7SR3Klg2x51dR4u7LSGHpGR+z++UwDfPlE/R5glxm+GR0EgqunL0KKCjfYBunf5w57yJonldHDuTIGpRTmi71OeGtlZyRrEWcUup4byrX2+e9KaCoeUvPV0JAZMSdBdCWrqsgudH++/59A9HiPZHEQMQm/VDKEAMPyQilsQ+FX9MqY0twfVrkBJwfNnRIoxcgsKPPXF822naKPJg0849uC6/4lBKvjYMJV97gHZVCVU+dVkH9sANP09BvCwEhh5e2vt5gStpKCrfi3/NOtR4b5T76nCUQN4/QV1NA+JLCpGISn7h9ukODhj6MsQapLNPR4Cs13E/z1rfYoAEO5vHT7rJFz/bQrfVW6zRWwXjqDRUQwNu+1ic1BlODgYSX4N8Coq0SErLV3gQ=
  password:
    secure: Qku90snqS7Dv1y1QQGWa7gmLVAUfvgW6GSfNarB7NWfU1PfsMuFKBAelQZayDRt6AN0+ZCW7EhOV8lK9uOsHRQLprKmv4kZPqIcUdFWV+OpW0aTv1BjlJQccq5UPQbu322tACZSEcKcNKkj61/dWlrBVn0cKg5Tp+GTtbH+nqoo22uR0Dv6Qz05WG2dfZoZiHDSuyPxzd6v7FJ8SmUJm0jx48g2TRVB9TmGor5X5EUBtyZzWSNdbQUkzZefGon6ddyIKwfyF2dzMbpztEW6fXZ+OQZ1jm7o6lFS4HSnloPjG/YWRli+ZSmKD3aAdHPoO4OyIqNrkAeD0dpTm0X9su+V3RhS0Uq5uTBVdnO7rws0HrdkPX3xh0PHOUAlSUxt1hOdCwYjyqkHyQCBJ3+XVMmPtoKdhB78mw/v00Zo6u60cuvzNcVDes7ldFNxojid0NDMwwQIdpzsV2H0LvX+pBiJG+rxpQonWw4FIa6gsA4aOLJWFgyBrHsDySC5ttfSNOo0oARB/II9Etw9OAHIlK8HE8199It0E5fqiQmHwKJx9C0omOMMGQucruI1fKtSCozHvBGFx/Psq03Q2i3a+I6S+9hMuvFGNga3jy+bLvsEgj5OF/7b/mlqgNhWRfJqpBITlGZhxAUwemG6Lsr5CbdOl5HEGiY4YPImBl/MfG0k=
  api: https://api.run.pivotal.io
  organization: EVP
  space: EMC
  manifest: manifest-travis.yml
  on:
    branch: master
    condition: "$DJANGO = '1.9.6'"
    python: '3.5'
notifications:
  slack:
    secure: R8t6WPl0jpSJXRsAAFbQvcI9EFj7gsMOjnC/fEzB+F9JlO891at8V0Y7yKLaajyG1salGzeUAGtaBgZ8Q3T3NpC4i290eQj+DseE8eSjH2u+9IlY1eOl+k7LGPQ7gg3leXIp58xmiU4GP+LEyTRG1LaFU5RyXzEdIyGrPBpsWZarIpbJiYunvpeiNOuIE5ctDoKTWgtIMTCTzEgGHV1Q9QaBB7yueXbgEWTHB43aGA5+tughyCfsvqzPRhllT5n8R+vqZawQ07JKHKQLm26+ifxk8wtt+TJARyMG8LKSIm7d0DeROOXPZMqpaG1+zHs3kp+I0Xbk4wblPCaJ5xinLdbqlNn/zGOynove0R/hcFlrvfXonWQkBcg7S71aUaG0oght1TMz0ABGiUMu7Pw2EmeRxFiMuHGBYEwu4LPcQToQSFHp4aS5DyNAed7XfAaehScs8bk7MDirhomZOXYxIu2evlzM0nF/7zAOVcqQA525XaKLaoZKE1gPT0axEcYOnkZIsSoMhNCJKXlBlnZP1c3YfZI8unfHOLh8Ez1IwRdvS/V1j5wzDXxqNtSLFt02i+19ht0TrA4kuW4m/UhFMvDNlsKIlpe/4gsXtgnPs5PHvx0Tuo5e2W+WMcnYytUoa1vce44X/3GHT7cV9+3tAxP7HCBsg3SwGxbRy5nMpIk=
